Opusmodus                                                                       add-sine-waves   1

add-sine-waves niter res freq amplitude &key phase modulation
[Function]

Arguments and Values:
niter                    a number representing the iteration of the wave.
res                      resolution and length of the wave.
freq                     a number representing the frequency of the wave.
amplitude                a number representing the amplitude of the wave.
                         or a sequence serving as alternating amplitudes.
phase                    a number repesenting the phase. The default is NIL.
modulation               if NIL no modulation, otherwise a wave. The default is NIL.


Description:

ADD-SINE-WAVES are generated by GEN-SINE niter times, halving freq at each
iteration. Arguments following niter are the same as in GEN-SINE.

(add-sine-waves 4 120 4 0.6)
=> (0.0 0.24242559252454451 0.47861382102721794
    0.7025733739167389 0.9087945473289307
    1.0924642622022922 . . .)


Examples:

The term niter is an abbreviation for n iterations. It is a form of frequency control making
possible a halving of frequency at each iteration. This is a feature of the famous Poincare
oscillation or section, which is a common feature of harmonic and dynamic systems. As with
the GEN-SINE examples the following demonstrate how the addition of :modulation
and :phase can have a rich impact on the distortions of the waveform.
Opusmodus                                        add-sine-waves   2

(list-plot (add-sine-waves 4 64 4 0.6))




(list-plot
 (add-sine-waves 4 120 1 0.6
  :modulation (gen-sine 120 1 0.4 :phase 60)))
Opusmodus                                                   add-sine-waves   3

(list-plot
 (add-sine-waves 4 120 4 0.6
  :modulation (gen-sine 120 1 0.4 :phase 60)))




(list-plot
 (add-sine-waves 4 120 4 0.6
  :modulation (gen-sine 120 1 '(0.5 0.2 0.1) :phase 60)))
Opusmodus                                                               add-sine-waves   4

Here below there's a clear example of how alternating amplitude values can affect the
wave output when the vectors are mapped to pitches.

(vector-to-pitch
 '(g3 g5)
 (add-sine-waves 4 64 4 0.6
  :modulation (gen-sine 64 1 '(0.5 0.2 0.1) :phase 60)))
=> (b3 f4 a4 ds5 e5 e5 cs5 d5 cs5 a4 a4 a4 cs5 as4 b4 e5 ds5 ds5
    e5 e5 e5 d5 cs5 b4 cs5 gs4 e4 b4 ds4 cs4 as4 cs4 f4 g4 e4
    cs5 ds4 b4 g5 cs4 fs5 f5 g4 f5 gs4 fs5 g4 d4 c5 d4 e4 ds4
    fs4 e4 b3 a3 g3 gs4 a3 gs3 a4 f5 b4 gs4)

The example score is a powerful example of how this function can produce captivating
results. Notice in particular how the rhythms and sections have been devised.


Score Example:
(setf size 200)
(setf vector1 (add-sine-waves
               4 size 1 0.6
               :modulation
               (gen-sine size 1 (sort-asc '(0.5 0.4 0.3 0.6 0.2 0.9))
               :modulation (gen-sine size 1 0.9 :phase 180))))

(setf vector2 (add-sine-waves
               4 size 4 0.6
               :modulation
               (gen-sine size 1 '(0.5 0.4 0.6)
                :modulation (gen-sine size 1 0.1 :phase 180))))

(setf pitch1 (gen-divide 4 (vector-to-pitch '(c1 gs6) vector1)))
(setf pitch2 (gen-divide 3 (vector-to-pitch '(c1 gs6) vector2)))
(setf transp (pitch-transpose -12 pitch2))
(setf variant (pitch-variant transp :variant 'i))

(setf len1 (gen-loop 2 (rnd-sample 20 '((6q = = = = =)))))
(setf len2 (gen-loop 2 (rnd-sample 20 '((q) (3q = =) (q)
                                        (e =) (3q= =) (q) (3q ==)))))
(setf dur1
      (assemble-seq
       (7~ (2~ len2)) '(3q= =) '(3q = =) '(3q = =) (1~ len1)
       (2~ len1) '(q)))

(setf dur2
      (assemble-seq
       (1~ (2~ len2)) (2~ (2~ len2)) (3~ (2~ len2)) (1~ (2~ len2))
       (1~ len2) (gen-repeat 6 '(3q = =))
       (rnd-sample 10 '((q) (3q = =) (q) (e =) (3q= =) (q) (3q ==)))
       (gen-repeat 4 '(3q = =)) '(q)))
Opusmodus                                                 add-sine-waves   5

(setf vel1 (gen-cresc-dim (get-count dur1 :sum t) 'pp 'mf))
(setf vel2 (gen-cresc-dim (get-count dur2 :sum t) 'pp 'mf))

(setf mat1 (make-omn
            :length dur1
            :pitch (filter-repeat 1 (flatten pitch1))
            :velocity vel1
            :flat t))

(setf mat2 (ambitus-scale 'piano '(c3 cs4)
                          (make-omn
                           :length dur2
                           :pitch variant
                           :velocity vel2
                           :flat t)))

(def-score add-sine
           (:title "Waves Add-Sine"
            :composer "OPMO"
            :copyright "Â© 2014 Opusmodus"
            :key-signature 'chromatic
            :time-signature '(4 4)
            :tempo 56
            :layout (piano-solo-layout 'rh 'lh))

  (rh :omn mat1
      ;:port 0
      :sound 'gm
      :channel 1
      :program 'acoustic-grand-piano)

  (lh :omn mat2))

  (display-midi (compile-score 'add-sine))
