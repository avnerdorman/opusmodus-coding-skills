Opusmodus                                                                             gen-square   1

gen-square res freq amplitude &key phase modulation
[Function]

Arguments and Values:
res                     resolution and length of the wave.
freq                    a number representing the frequency of the wave.
amplitude               a number representing the amplitude of the wave.
                        or a sequence serving as alternating amplitudes.
phase                   a number representing the phase. The default is NIL.
modulation              if NIL no modulation, otherwise a wave. The default is NIL.


Description:

The GEN-SQUARE function generates a sequence of vectors that describe and simulate the
characteristics of a square wave.

(gen-square 32 1 0.5)
=> (0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5
    0.5 0.5 0.5 0.5 0.5 0.5 . . .)

With control over resolution (the length of the wave), frequency and amplitude (and
additional control over :phase and :modulation) this function can be a remarkably
effective tool for creating gestural forms in pitch, rhythm, dynamics and structure.


Examples:

With the function LIST-PLOT as a guide it's possible to experiment with shapes and forms
before applying these to musical parameters.
Opusmodus                                                                 gen-square   2

(list-plot (gen-square 120 3 0.5))




In the example below the keyword :modulation is applied and its values are generated by
another wave produced by the GEN-SQUARE function.

(list-plot
 (gen-square 120 3 0.5 :modulation (gen-square 120 1 0.2)))
Opusmodus                                                              gen-square     3

In the example below the amplitude parameter '(0.5 0.2 0.1) has three values. These
represent a sequence of alternating amplitudes.

(list-plot
 (gen-square 120 1 '(0.5 0.2 0.1) :modulation (gen-square 120 1 0.3)))
Opusmodus                                                                     gen-square     4

In this nal example the keyword :phase is used to produce a different start point (90) in
the 360 degree range of the modulating wave.

(list-plot
 (gen-square 120 1 '(0.5 0.2 0.1)
             :modulation (gen-square 120 1 0.3 :phase 90)))




Here below there's a clear example of how alternating amplitude values can affect the wave
output when the vectors are mapped to pitches.

(vector-to-pitch '(g3 g5)
 (gen-square 120 7 '(0.5 0.2 0.1)
  :modulation (gen-square 120 3 0.3 :phase 90)))
=> (g5 c5 a4 g5 c5 a4 g5 d4 f4 g3 c5 f4 g3 d4 f4 g3 d4
    f4 g3 d4 f4 g3 c5 a4 g5 c5 a4 g5 c5 a4 g5 c5 a4 g5
    c5 f4 g3 d4 f4 g3 d4 f4 g5 c5 a4 g5 c5 a4 g5 d4 a4
    g5 c5 f4 g3 d4 f4 g3 d4 f4 g3 d4 f4 g3 c5 a4 g5 c5
    a4 g5 c5 a4 g5 c5 a4 g5 c5 f4 g3 d4 f4 g3 d4 f4 g5
    c5 a4 g5 c5 a4 g5 c5 a4 g5 c5 f4 g3 d4 f4 g3 d4 f4
    g3 d4 f4 g3 c5 a4 g5 c5 f4 g3 c5 a4 g5 c5 a4 g5 c5
    f4)
fi
Opusmodus                                                                   gen-square   5

The example score is a powerful example of how this function can produce captivating
results. Notice in particular how the rhythms and sections have been devised.


Score Example:
(setf size 120)
(setf vector (gen-square size 1 '(0.5 0.4 0.3 0.6)
                   :modulation (gen-square size 1 0.3 :phase 180)))

(setf pitches (gen-divide 4 (vector-to-pitch '(g1 g6) vector)))
(setf transp (rnd-sample size '(-13 -12 -11 -6 -1 1 6 11 12 13)))
(setf transpose (pitch-transpose transp pitches))
(setf section (rnd-unique (/ (length pitches) 2)
                          (gen-integer 0 (1- (length pitches)))))

(setf variants (pitch-variant transpose :variant '? :section section))
(setf dur1 (rnd-sample (- size 9) '(s e s s)))
(setf dur2 '(s s s s s s s s q))
(setf duration (flatten (list dur1 dur2)))
(setf dur-rh (span pitches duration))
(setf dur-lh (span variants duration))
(setf dynamics '(p mp mf f ff fff))

(def-score square
           (:key-signature 'chromatic
            :time-signature (get-time-signature dur-rh)
            :tempo 100)

     (right-hand
      :length dur-rh
      :pitch pitches
      :velocity (rnd-sample size dynamics)
      :sound 'gm
      :channel 1
      :program 'acoustic-grand-piano)

     (left-hand
      :length dur-lh
      :pitch variants
      :velocity (rnd-sample size dynamics))
 )

(display-midi (compile-score 'square))
