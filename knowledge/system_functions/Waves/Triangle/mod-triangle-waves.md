Opusmodus                                                                 mod-triangle-waves   1

mod-triangle-waves niter res freq amplitude
                               &key phase modulation variant

[Function]

Arguments and Values:
niter                   a number representing the iteration of the wave.
res                     resolution and length of the wave.
freq                    a number representing the frequency of the wave.
amplitude               a number representing the amplitude of the wave.
                        or a sequence serving as alternating amplitudes.
phase                   a number repesenting the phase. The default is NIL.
modulation              if NIL no modulation, otherwise a wave. The default is NIL.
variant                 1 or 2. The default is 1.


Description:

Modulating iterations of triangle-waves as generated by GEN-TRIANGLE niter times.
Arguments following niter are the same as in GEN-TRIANGLE.

(mod-triangle-waves 4 32 4 0.6)
=> (0.0 0.3937849275424689 0.4239629680824127
    0.2106554051840677 0.0 -0.2645350868594118
    -0.5994248585177249 . . .)


Examples:

The term niter is an abbreviation for N iterations. It is a form of frequency
control making possible a halving of frequency at each iteration. This is a feature of
the famous Poincare oscillation or section, which is a common feature of harmonic and
dynamic systems. As with the GEN-TRIANGLE examples the following demonstrate how
the addition of :modulation and :phase can have a rich impact on the distortions of the
waveform.
Opusmodus                                            mod-triangle-waves   2

(list-plot (mod-triangle-waves 1 120 4 0.6))




(list-plot
 (mod-triangle-waves 1 120 1 0.6
  :modulation (gen-triangle 120 1 0.4 :phase 60)))
Opusmodus                                                        mod-triangle-waves   3

In the example below a new keyword is introduced :variant. This has two positions 1
and 2 of which 1 is the default.

(list-plot
 (mod-triangle-waves 50 120 4 0.3
  :modulation (gen-triangle 120 1 0.4)))




(list-plot
 (mod-triangle-waves 50 120 4 0.3
  :modulation (gen-triangle 120 1 0.4) :variant 2))
Opusmodus                                                              mod-triangle-waves      4

Here below there's a clear example of how alternating amplitude values can affect the wave
output when the vectors are mapped to pitches.

(vector-to-pitch
 '(g3 g5)
  (mod-triangle-waves 4 64 4 0.6
   :modulation (gen-triangle 64 1 '(0.5 0.2 0.1) :phase 60)))
=> (g4 as4 ds5 fs5 ds5 cs5 a4 gs4 fs4 b3 b3 a3 ds4 cs4
    d4 e4 a4 b4 g5 c5 as3 fs4 f4 g5 e5 d5 a3 g5 a3 f5
    gs3 gs3 fs5 gs4 e4 f5 b4 b3 gs4 g3 b4 cs4 g4 e5 e4
    f4 b3 gs4 ds5 c4 a4 g3 gs4 c4 cs5 c4 f4 g4 d4 ds5
    e5 b3 b3 ds4)

These complex visual gestures can be used most effectively to structure distinctive patterns
in pitch and dynamics parameters. The score example amply demonstrates this.


Score Example:
(setf size 400)
(setf vector
      (mod-triangle-waves
       12 size 1 0.9
       :modulation
       (gen-triangle
        size 5 '(0.9)
        :modulation (gen-triangle size 1 0.3 :phase 247))
       :variant 2))

(setf pitches (gen-divide 4 (vector-to-pitch '(g1 g6) vector)))
(setf transp (rnd-sample size '(-13 -11 -6 -1 -2 1 2 6 11 13)))
(setf transpose (pitch-transpose transp pitches))
(setf variant (pitch-variant transpose :variant '?))

(setf duration '((3e = =) (3e ==)
                 (5e = = = =) (5e = == =)
                 (7q = = = = = =) (7q = = == = =)))

(setf length1 (rnd-order (rnd-sample 120 duration)))
(setf length2 (rnd-order (rnd-order length1 :list t)))
(setf dynamics (rnd-sample size '(p mf ff)))
Opusmodus                                               mod-triangle-waves   5

(setf mat1
      (ambitus-scale 'piano '(c5 c6)
                     (make-omn
                      :length length1
                      :pitch pitches
                      :velocity dynamics
                      :flat t)))

(setf mat2
      (ambitus-scale 'piano '(c5 c6)
                     (make-omn
                      :length length2
                      :pitch variant
                      :velocity dynamics
                      :flat t)))

(def-score mod-triangle
           (:title "Waves Mod-Triangle"
            :composer "OPMO"
            :copyright "Â© 2014 Opusmodus"
            :key-signature 'chromatic
            :time-signature (get-time-signature mat1)
            :tempo 88
            :layout (list (grand-layout 'rh)
                          (grand-layout 'lh)))

  (rh :omn mat1
      :sound 'gm
      :channel 1
      :program 'acoustic-grand-piano)

  (lh :omn mat2))
